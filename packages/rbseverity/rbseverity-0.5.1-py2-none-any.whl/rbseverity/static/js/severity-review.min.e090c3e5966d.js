(function(){RBSeverity={};RBSeverity.CommentDialogHookView=Backbone.View.extend({events:{"click .buttons .save-major":"_onSaveMajorClicked","click .buttons .save-minor":"_onSaveMinorClicked","click .buttons .save-info":"_onSaveInfoClicked"},buttonsTemplate:_.template(['<span class="severity-actions">','  <input type="button" class="save-major" value="Major" ','         disabled="true" />','  <input type="button" class="save-minor" value="Minor" ','         disabled="true" />','  <input type="button" class="save-info" value="Info" ','         disabled="true" />',"</span>"].join("")),initialize:function(options){this.commentDialog=options.commentDialog;this.commentEditor=options.commentEditor},render:function(){var $severityButtons=$(this.buttonsTemplate());this.commentDialog.$saveButton.remove();this.commentDialog.$buttons.prepend($severityButtons);$severityButtons.find("input").bindVisibility(this.commentEditor,"canEdit").bindProperty("disabled",this.commentEditor,"canSave",{elementToModel:false,inverse:true});this.commentEditor.setExtraData("severity","info")},_onSaveMajorClicked:function(){this._saveCommon("major")},_onSaveMinorClicked:function(){this._saveCommon("minor")},_onSaveInfoClicked:function(){this._saveCommon("info")},_saveCommon:function(severity){if(this.commentEditor.get("canSave")){this.commentEditor.setExtraData("severity",severity);this.commentDialog.save()}}});RBSeverity.ReviewDialogCommentHookView=Backbone.View.extend({events:{"change select":"_onSeverityChanged"},template:_.template(['<label for="<%- id %>">Severity:</label> ','<select id="<%- id %>">',' <option value="major">Major</option>',' <option value="minor">Minor</option>',' <option value="info">Info</option>',"</select>"].join("")),render:function(){var severity=this.model.get("extraData").severity;this.$el.html(this.template({id:"severity_"+this.model.id}));this._$select=this.$("select");if(severity){this._$select.val(severity)}else{this._$select.prepend($("<option selected/>"))}return this},_onSeverityChanged:function(){this.model.get("extraData").severity=this._$select.val()}});RBSeverity.Extension=RB.Extension.extend({initialize:function(){_super(this).initialize.call(this);new RB.CommentDialogHook({extension:this,viewType:RBSeverity.CommentDialogHookView});new RB.ReviewDialogCommentHook({extension:this,viewType:RBSeverity.ReviewDialogCommentHookView})}})}).call(this);