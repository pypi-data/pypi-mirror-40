#!/Users/danny/virtenvs/pol/bin/python

"""
python script to make an hdf5 store of one corpus
"""

import sys
from polly import Corpus
from buzzword import store_as_hdf, cmd_line_to_kwargs

colmax = cmd_line_to_kwargs(list(sys.argv[2:]))

kwargs = {}
if 'chunksize' in colmax:
    kwargs['chunksize'] = kwargs.pop('chunksize')
if colmax:
    print("Column sizes defined: ", colmax)

corpus = Corpus(sys.argv[1])
name = corpus.name.replace('-parsed', '')
loaded = corpus.load(load_trees=False, multiprocess=3)
store_as_hdf(loaded, name=name, colmax=colmax, **kwargs)
print("\n\n%s added." % name)
