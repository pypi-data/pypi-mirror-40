dist: xenial
sudo: false
language: python

python:
- 3.6
- &latest_py3 3.7

jobs:
  fast_finish: true
  include:
  - stage: deploy
    if: tag IS present
    python: *latest_py3
    before_script: skip
    env:
    - TWINE_USERNAME=jaraco
    # TWINE_PASSWORD
    - secure: 0g63CL375fK4wHmYnrvSKwDdpIS/fmCOS57QD8vMWmu8V9ayuc1H13UzOCivFGAemei3eNFp9Kh3/AjVZ8iIWbnW4UjM20DALmqbIBl6u53XhgTA5XTKiEuLTM+NvsgLQNZi0YttmN+Dy7QPChlpf+VLeLPc0Az2tjgVfnu3t7CDuDSBu4XzG05ClgoXgG/8U8Q3jUi2FDX10PCQbM7jXMbVvLQsk76U6jWh+/qQvCKo/ut/oQqyCd8818s6vg/QA9jBNKyQCTRJGeJ+IzJUa1GiE+TqmqB5e7d30psbyYdeSeCyksUs7sJfMAM//rFEcY4KchRxiTXg0Jr5vSBZWGnLGqZtSe61x7QSLDAqP3QBjHVWMLCG85QgcSXwHJnRHhpgIH6eUxMaPOTifiqJfYN2WXpfhycLIg1H+AexXz6Sd5pAAf8Y33Yfsun/u5Q4G2YBi1LWRPLVJpeOAriwD5BR8bh57UqDj/Owrte6mrgMhGofcRnf+qXuXjDwCFgvJ31SilI7fYjpBUaGsQy5wAc4WTinqTZySlXovMyWgqR5uXq8AA4ZswPAHQJrlvp2aQ9fF0I1DEAPdGdDDZY8qYtytHvKHWF19l+LibU94BohYNxfgKcR6CJwlawrHjNQxqRABAMKeuVf6r+V6nbo6e3+bwbVEm5tI3aYO/V4YxY=
    - TOX_TESTENV_PASSENV="TWINE_USERNAME TWINE_PASSWORD"
    script: tox -e release

cache: pip

install:
- pip install tox tox-venv

before_script:
  # Disable IPv6. Ref travis-ci/travis-ci#8361
  - if [ "${TRAVIS_OS_NAME}" == "linux" ]; then
      sudo sh -c 'echo 0 > /proc/sys/net/ipv6/conf/all/disable_ipv6';
    fi
script: tox
